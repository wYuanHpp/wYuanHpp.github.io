<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="å‰è¨€å‰ç«¯ç¤¾åŒºæ—©åœ¨å‡ å¹´å‰å°±è¿›åˆ°äº†æ¨¡å—åŒ–å¼€å‘æ–¹å¼ä¸­äº†, å®é™…ä¸Šes6ä¹‹å‰, jsæ˜¯æ²¡æœ‰æ¨¡å—æ¦‚å¿µçš„. æ—¢æ²¡æœ‰å˜é‡çš„å¯¼å‡º, ä¹Ÿæ²¡æœ‰å˜é‡çš„å¼•å…¥.  éšç€å‰ç«¯éœ€è¦æ‰¿æ‹…çš„åŠŸèƒ½è¶Šæ¥è¶Šç¹é‡, éœ€è¦å¤ç”¨çš„é€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤š, å…¨å±€å˜é‡è¶Šæ¥è¶Šå®¹æ˜“ç¢°æ’, å‰ç«¯æ€¥éœ€ä¸€ä¸ªæ¨¡å—åŒ–æ–¹æ¡ˆ. é‚£ä¹ˆæ—¢ç„¶javascriptè¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æ¨¡å—åŒ–åŠŸèƒ½, ä½†æ˜¯å¤§ä½¬ä»¬å¿…ç„¶æ˜¯æœ‰åŠæ³•çš„. äºæ˜¯å„ç§æ¨¡å—åŒ–æ–¹æ¡ˆåˆ†åˆ†å‡ºç°CMD AMD CommonJS,">
<meta property="og:type" content="article">
<meta property="og:title" content="å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ">
<meta property="og:url" content="http://yoursite.com/2020/04/27/å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="å‰è¨€å‰ç«¯ç¤¾åŒºæ—©åœ¨å‡ å¹´å‰å°±è¿›åˆ°äº†æ¨¡å—åŒ–å¼€å‘æ–¹å¼ä¸­äº†, å®é™…ä¸Šes6ä¹‹å‰, jsæ˜¯æ²¡æœ‰æ¨¡å—æ¦‚å¿µçš„. æ—¢æ²¡æœ‰å˜é‡çš„å¯¼å‡º, ä¹Ÿæ²¡æœ‰å˜é‡çš„å¼•å…¥.  éšç€å‰ç«¯éœ€è¦æ‰¿æ‹…çš„åŠŸèƒ½è¶Šæ¥è¶Šç¹é‡, éœ€è¦å¤ç”¨çš„é€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤š, å…¨å±€å˜é‡è¶Šæ¥è¶Šå®¹æ˜“ç¢°æ’, å‰ç«¯æ€¥éœ€ä¸€ä¸ªæ¨¡å—åŒ–æ–¹æ¡ˆ. é‚£ä¹ˆæ—¢ç„¶javascriptè¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æ¨¡å—åŒ–åŠŸèƒ½, ä½†æ˜¯å¤§ä½¬ä»¬å¿…ç„¶æ˜¯æœ‰åŠæ³•çš„. äºæ˜¯å„ç§æ¨¡å—åŒ–æ–¹æ¡ˆåˆ†åˆ†å‡ºç°CMD AMD CommonJS,">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-04-27T14:05:39.259Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ">
<meta name="twitter:description" content="å‰è¨€å‰ç«¯ç¤¾åŒºæ—©åœ¨å‡ å¹´å‰å°±è¿›åˆ°äº†æ¨¡å—åŒ–å¼€å‘æ–¹å¼ä¸­äº†, å®é™…ä¸Šes6ä¹‹å‰, jsæ˜¯æ²¡æœ‰æ¨¡å—æ¦‚å¿µçš„. æ—¢æ²¡æœ‰å˜é‡çš„å¯¼å‡º, ä¹Ÿæ²¡æœ‰å˜é‡çš„å¼•å…¥.  éšç€å‰ç«¯éœ€è¦æ‰¿æ‹…çš„åŠŸèƒ½è¶Šæ¥è¶Šç¹é‡, éœ€è¦å¤ç”¨çš„é€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤š, å…¨å±€å˜é‡è¶Šæ¥è¶Šå®¹æ˜“ç¢°æ’, å‰ç«¯æ€¥éœ€ä¸€ä¸ªæ¨¡å—åŒ–æ–¹æ¡ˆ. é‚£ä¹ˆæ—¢ç„¶javascriptè¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æ¨¡å—åŒ–åŠŸèƒ½, ä½†æ˜¯å¤§ä½¬ä»¬å¿…ç„¶æ˜¯æœ‰åŠæ³•çš„. äºæ˜¯å„ç§æ¨¡å—åŒ–æ–¹æ¡ˆåˆ†åˆ†å‡ºç°CMD AMD CommonJS,">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/27/å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ/" class="article-date">
  <time datetime="2020-04-27T13:53:54.000Z" itemprop="datePublished">2020-04-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å‰ç«¯ç¤¾åŒºæ—©åœ¨å‡ å¹´å‰å°±è¿›åˆ°äº†æ¨¡å—åŒ–å¼€å‘æ–¹å¼ä¸­äº†, å®é™…ä¸Šes6ä¹‹å‰, jsæ˜¯æ²¡æœ‰æ¨¡å—æ¦‚å¿µçš„. æ—¢æ²¡æœ‰å˜é‡çš„å¯¼å‡º, ä¹Ÿæ²¡æœ‰å˜é‡çš„å¼•å…¥. </p>
<p>éšç€å‰ç«¯éœ€è¦æ‰¿æ‹…çš„åŠŸèƒ½è¶Šæ¥è¶Šç¹é‡, éœ€è¦å¤ç”¨çš„é€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤š, å…¨å±€å˜é‡è¶Šæ¥è¶Šå®¹æ˜“ç¢°æ’, å‰ç«¯æ€¥éœ€ä¸€ä¸ªæ¨¡å—åŒ–æ–¹æ¡ˆ. é‚£ä¹ˆæ—¢ç„¶<code>javascript</code>è¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æ¨¡å—åŒ–åŠŸèƒ½, ä½†æ˜¯å¤§ä½¬ä»¬å¿…ç„¶æ˜¯æœ‰åŠæ³•çš„. äºæ˜¯å„ç§æ¨¡å—åŒ–æ–¹æ¡ˆåˆ†åˆ†å‡ºç°<code>CMD</code> <code>AMD</code> <code>CommonJS</code>, å†es6è§„èŒƒå‡ºæ¥å‰, è¿™ä¸‰ç§æ–¹æ¡ˆå‡ ä¹ç»Ÿæ²»äº†æ‰€æœ‰<code>javascript</code>å¼€å‘. ä»–ä»¬éƒ½åœ¨è‡ªå·±ä¸åŒçš„é¢†åŸŸä»–æå‡ºäº†å®ç°æ–¹æ¡ˆ, å¹¶è§£å†³äº†è¯¸å¤šçš„é—®é¢˜.</p>
<p>æ²¡æƒ³åˆ°çš„æ˜¯, å‰ç«¯æ˜¯åœ¨å˜åŒ–å¤ªå¿«, 2015å¹´es6å‘å¸ƒ, ä»æ­¤<code>javascript</code>æœ‰äº†è‡ªå·±çš„æ¨¡å—åŒ–æ–¹æ¡ˆ. å¹¶ä¸”å¾ˆå¿«, åŸºäºæ¨¡å—åŒ–çš„æ‰“åŒ…å·¥å…·<code>webpack</code>å‘å¸ƒ, æŠŠå‰ç«¯å·¥ç¨‹åŒ–æ‹‰ä¸Šä¸€ä¸ªå…¨æ–°é«˜åº¦â€”-ä¸‡ç‰©çš†æ¨¡å—.<br>å–„äºæ¥å—å˜åŒ–çš„å‰ç«¯ç¤¾åŒºç»Ÿç»Ÿæ‹¥æŠ±<code>webpack</code>, å¾ˆå¿«<code>webpack</code>å¤©ä¸‹å¤§ç»Ÿ, ä¹‹å‰çš„ä¸‰å¤§è§£å†³æ–¹æ¡ˆ,é™¤äº†<code>commonJS</code>å› ä¸º<code>NodeJS</code>äº²å„¿å­çš„é«˜è´µè¡€ç»Ÿ, <code>CMD</code> <code>AMD</code>çš„ä¸¤ä¸ªæ–¹æ¡ˆ<code>require.js</code> <code>sea.js</code>å‡ ä¹å·²ç»å‘Šåˆ«æ±Ÿæ¹–, æˆä¸ºå†å², å˜æˆäº†è€å‰ç«¯å›å¿†è‡ªå·±å³¥åµ˜å²æœˆçš„è°ˆèµ„äº†. æ˜¯ä¸æ˜¯å¾ˆåƒ<code>jquery</code>çš„ç»å†?</p>
<p>æ—¢ç„¶<code>webpack</code>è¿™ä¹ˆå‰å®³, é‚£ä¹ˆä»–çš„æ‰“åŒ…æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ? æ˜¯<code>esModule</code>ä¹ˆ?</p>
<h3 id="webpackæ—¶ä»£"><a href="#webpackæ—¶ä»£" class="headerlink" title="webpackæ—¶ä»£"></a>webpackæ—¶ä»£</h3><p>å®é™…ä¸Šç”±äºwebpackæ˜¯åŸºäº<code>NodeJs</code>çš„è¿è¡Œæ—¶, æ‰€ä»¥webpackæ˜¾ç„¶ä¸€å¼€å§‹æ˜¯ä½¿ç”¨çš„<code>commonJS</code>çš„æ–¹æ¡ˆ, ç›¸æ¯”<code>CMD</code> <code>AMD</code>,<code>commonJS</code>çš„ç¾¤ä½“æ¯”è¾ƒå¤§, å› ä¸ºæ˜¯è¿è¡Œå†<code>NodeJS</code>ä¸Š, <code>webpack</code>çš„é…ç½®æ–‡ä»¶,plugin,loader,éƒ½å¿…é¡»ä½¿ç”¨<code>commonJS</code>çš„æ–¹å¼æ¥å¼•å…¥, æ‰€ä»¥å…¶ä»–ä»£ç å¦‚æœéƒ½æ˜¯ç”¨ä¸€å¥—æ–¹æ¡ˆ,è¿™æ ·ä¹Ÿæ¯”è¾ƒç»Ÿä¸€, ä¹Ÿç¬¦åˆç›´è§‰. </p>
<p>è™½ç„¶webpackå†jsä»£ç çš„æ¨¡å—åŠ è½½æ˜¯æŒ‰ç…§<code>commonJS</code>è§„èŒƒæ¥çš„, ä½†æ˜¯å®é™…ä¸Šç”±äºæ‰“åŒ…åçš„ä»£ç æ˜¯è¿è¡Œå†å‰ç«¯çš„, æ‰€ä»¥éœ€è¦å®ç°ä¸€ä¸ªå‰ç«¯çš„æ¨¡å—åŠ è½½è¿è¡Œæ—¶, é‚£ä¹ˆwebpackåˆ°åº•æ˜¯æ€ä¹ˆè®©åŸºäº<code>nodeJS</code>çš„æ¨¡å—ç³»ç»Ÿå†æ‰“åŒ…åèƒ½æˆåŠŸè¿è¡Œå†å‰ç«¯å‘¢?</p>
<h3 id="å¦‚ä½•å®ç°ä¸€ä¸ªæ¨¡å—"><a href="#å¦‚ä½•å®ç°ä¸€ä¸ªæ¨¡å—" class="headerlink" title="å¦‚ä½•å®ç°ä¸€ä¸ªæ¨¡å—"></a>å¦‚ä½•å®ç°ä¸€ä¸ªæ¨¡å—</h3><p>ç†æƒ³çš„ä¸€ä¸ªjs moduleåº”è¯¥æ˜¯æœ‰è‡ªå·±çš„ç¯å¢ƒ, æ¨¡å—ä¹‹é—´äº’ç›¸æ— æ³•å½±å“, ç›¸äº’è§çš„å…¨å±€å˜é‡éƒ½æ˜¯ä¸å¯è§çš„. å¹¶ä¸”æ¨¡å—éœ€è¦å¯ä»¥å¯¼å‡ºæ•°æ®, è¿˜è¦èƒ½å¤ŸåŠ è½½å…¶ä»–æ¨¡å—å¯¼å‡ºçš„æ•°æ®.é‚£ä¹ˆè¿™æ ·çš„åŠŸèƒ½æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°å‘¢?</p>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>æˆ‘ä»¬å…ˆå®šä¹‰ä¸¤ä¸ªä¸‰ä¸ªæ–‡ä»¶, äº’ç›¸åŠ è½½ä¸€ä¸‹:</p>
<p><em>/index.js</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'./dep.js'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure></p>
<p><em>/dep.js</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'./common.js'</span>)</span><br><span class="line"><span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = funA;</span><br></pre></td></tr></table></figure></p>
<p><em>/common.js</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> util = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = util;</span><br></pre></td></tr></table></figure></p>
<p>ä»–ä»¬çš„ä¾èµ–å…³ç³»å¦‚ä¸‹: <code>index.js</code> -&gt; <code>dep.js</code> -&gt; <code>common.js</code>;</p>
<p>å¥½äº†, æ—¢ç„¶ä¸Šé¢çš„ç¤ºä¾‹å·²ç»å®šå¥½äº†, ä½¿ç”¨çš„æ˜¯<code>commonJS</code>çš„è§„èŒƒ, æ—¢ç„¶æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç®€å•ç‰ˆçš„æ¨¡å—ç³»ç»Ÿ, é‚£ä¹ˆå…ˆæ¥åˆ†æåˆ†æè¿™é‡Œä¼šç”¨åˆ°çš„è¯­æ³•æŠŠ</p>
<h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import ä»£ç </span></span><br><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'./a.js'</span>)</span><br><span class="line"><span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="comment">// export å¯¼å‡ºä»£å‘æ–¹å¼1</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  funA</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// or å¯¼å‡ºä»£ç æ–¹å¼2</span></span><br><span class="line">exports.funcA = funA;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šé¢çš„ä¸¤ç§å¯¼å‡ºæ–¹å¼æ˜¯ç­‰ä»·çš„</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ä»£ç ,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°, è¿™é‡Œæœ‰ä¸‰ä¸ªå…¨å±€å˜é‡<code>require</code> <code>module</code> <code>exports</code>, è¿™ä¸‰ä¸ªå…¨å±€å˜é‡æˆ‘ä»¬å¾…ä¼šå†è¯´</p>
<h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><p>ok, æ—¢ç„¶æ˜¯æ¨¡å—, é¦–å…ˆéœ€è¦è€ƒè™‘çš„å°±æ˜¯éš”ç¦»å…¨å±€å˜é‡, æ¢è€Œè¨€ä¹‹å°±æ˜¯è¦è®©æ¯ä¸€ä¸ªæ¨¡å—çš„æ‰§è¡Œç¯å¢ƒéƒ½åœ¨ä¸åŒçš„ä½œç”¨äºä¸‹,<br>é‚£ä¹ˆå¦‚ä½•å½¢æˆæ–°çš„ä½œç”¨äºæˆ‘å°±ä¸å¤šè¯´äº†,åªè¦ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æŠŠæ¨¡å—ä¸­çš„ä»£ç è¿›è¡ŒåŒ…è£¹å°±å¯ä»¥äº†,å°±åƒè¿™æ ·:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'./a.js'</span>)</span><br><span class="line">  <span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">  <span class="comment">// export</span></span><br><span class="line">  <span class="built_in">module</span>.exports = funA;</span><br><span class="line">  <span class="comment">// or</span></span><br><span class="line">  exports.funA = funA</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æ¨¡å—å…§çš„å…¨å±€å˜é‡å°±éƒ½å˜æˆäº†è¿™ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡, ç°åœ¨åªéœ€æŠŠå…¨å±€å˜é‡é€šè¿‡æ¨¡å—çš„å‡½æ•°å‚æ•°ä¼ å…¥, é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜:</p>
<ul>
<li>å¦‚ä½•æŠŠæ‰€æœ‰çš„æ¨¡å—éƒ½æ”¹å†™æˆåŒ…è£¹å‡½æ•°çš„æ–¹å¼, å¹¶ä¸”æŠŠè¿™äº›å‡½æ•°æ‰¾ä¸ªåœ°æ–¹ç»Ÿä¸€ç®¡ç†èµ·æ¥</li>
<li>å¦‚ä½•å®ç°<code>require</code> å’Œ <code>module</code> <code>exports</code> è¿™ä¸‰ä¸ªå˜é‡</li>
</ul>
<h3 id="è§£æä¾èµ–æ ‘"><a href="#è§£æä¾èµ–æ ‘" class="headerlink" title="è§£æä¾èµ–æ ‘"></a>è§£æä¾èµ–æ ‘</h3><p>ç¬¬ä¸€ä¸ªé—®é¢˜, å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« , ä½¿ç”¨<code>babel</code>æ¥è§£æå…¥å£æ–‡ä»¶<code>index.js</code></p>
<p>å› ä¸ºåœ¨è§£æè¿‡ç¨‹ä¸­, æˆ‘ä»¬éœ€è¦è·å–æ‰€æœ‰çš„æ¨¡å—, å¹¶ä¸”ç”Ÿæˆè¿™ä¸ªæ¨¡å—çš„å”¯ä¸€id, æ–¹ä¾¿èµ·è§, æˆ‘ä»¬ç›´æ¥å·²æ¨¡å—çš„é¡¹ç›®ç›¸å¯¹è·¯å¾„ä¸ºkeyæ¥è®°å½•</p>
<p>æ•´ä¸ªè¿‡ç¨‹å¤§æ¦‚åˆ†ä¸‹é¢å‡ éƒ¨:</p>
<ol>
<li>ä»å…¥å£æœªè§è§£æ, åªè¦é‡åˆ°requireæ–¹æ³•çš„è°ƒç”¨, å°±è§£æä»–çš„å‚æ•°æ¥è¯»å–å¯¹åº”çš„æ¨¡å—æ–‡ä»¶, å¹¶ä¿®æ”¹requireçš„å‚æ•°ä¸ºrequireæ–‡ä»¶çš„é¡¹ç›®ç›¸å¯¹è·¯å¾„</li>
<li>è®°å½•ä¸‹æ–‡ä»¶çš„è·¯å¾„, å¹¶jsæ–‡ä»¶å­—ç¬¦ä¸²,å¯¹å…¶è¿›è¡ŒåŒ…è£¹</li>
<li>é€’å½’çš„é‡å¤ä¸Šé¢ä¸¤æ­¥è§£æjsç›´åˆ°è·å–æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶.</li>
<li>éå†åç”Ÿæˆä¸€ä¸ªè·¯å¾„åˆ°æ¨¡å—çš„mappingå³å¯, ç”Ÿæˆåçš„æ¨¡å—å›¾å¤§æ¦‚å¦‚æ­¤<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loadedModulesMap = &#123;</span><br><span class="line">  <span class="string">'src/dep.js'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123; </span><br><span class="line">    <span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'src/common.js'</span>)</span><br><span class="line">    <span class="comment">/* code */</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'src/common.js'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123; <span class="comment">/* code */</span> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="å®ç°require"><a href="#å®ç°require" class="headerlink" title="å®ç°require"></a>å®ç°require</h3><p>è§£å†³ç¬¬äºŒä¸ªé—®é¢˜, ç å­—å¤ªéº»çƒ¦, ç›´æ¥ä¸Šä»£ç æŠŠ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œè®°å½•çš„æ˜¯ç¬¬ä¸€æ­¥è§£æå‡ºæ¥çš„æ‰€æœ‰ä¾èµ–æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> loadedModulesMap = &#123;</span><br><span class="line">  <span class="string">'src/dep.js'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'src/common.js'</span>)</span><br><span class="line">    <span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = funA;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'src/common.js'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> util = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = util; </span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ç¼“å­˜, é˜²æ­¢é‡å¤åŠ è½½ç›¸åŒçš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> cacheModulesMap = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰requireæ–¹æ³•</span></span><br><span class="line"><span class="built_in">require</span>(path) &#123;</span><br><span class="line">  <span class="comment">// å…ˆèµ°ç¼“å­˜</span></span><br><span class="line">  <span class="keyword">if</span> (cacheModulesMap[path]) &#123;</span><br><span class="line">    <span class="keyword">return</span> cacheModulesMap[path].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// æ³¨å†Œç¼“å­˜, æ‹¿åˆ°ç¼“å­˜ä¸Šçš„å¼•ç”¨æŒ‡é’ˆ</span></span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">module</span> = cacheModulesMap[path] = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">  <span class="comment">// å»æ¨¡å—mapé‡Œæ‹¿å¯¹åº”çš„æ¨¡å—</span></span><br><span class="line">  <span class="keyword">const</span> modulesFn = loadedModulesMap.path;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ¨¡å—, è¿™é‡Œè¦æ³¨æ„, æ¨¡å—çš„å¯¼å‡ºå€¼ç°å†™å…¥çš„moduleä¸Š, ç”±äºmoduleæ˜¯</span></span><br><span class="line">  <span class="comment">// cacheModulesMapçš„å¼•ç”¨, æ‰€ä»¥å¯¼å‡ºå€¼éƒ½ä¼šåŒæ—¶è¢«ä¿å­˜</span></span><br><span class="line">  modulesFn(<span class="built_in">require</span>, <span class="built_in">module</span>, <span class="built_in">module</span>.exports );</span><br><span class="line">  <span class="comment">// moduleå·²ç»æ‹¿åˆ°å¯¼å‡ºå€¼äº†, ç›´æ¥è¿”å›å¯¹åº”å¯¼å‡ºå€¼</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.export;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œå…¥å£æ–‡ä»¶ä»£ç , ä¸€åˆ‡æ…¢æ…¢å±•å¼€</span></span><br><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'src/dep.js'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·, ä¸€ä¸ªè§£æåçš„ä»£ç , å°±å¯ä»¥è¢«æ­£å¸¸çš„è¿è¡Œäº†, è¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ª<code>commonJS</code>æ¨¡å—çš„ä¸€ä¸ªç‰¹ç‚¹, å°±æ˜¯æ¨¡å—çš„åŠ è½½æ˜¯åœ¨è¿è¡Œæ—¶å®Œæˆçš„, ä¹Ÿå°±æ˜¯è¯´, åªæœ‰åœ¨ä»£ç è¿è¡Œçš„æ—¶å€™, æ¨¡å—æ‰ä¼šè¢«åŠ è½½, å¹¶ä¸”åŠ è½½é¡ºåºå’Œä»£ç çš„è°ƒç”¨é¡ºåºæ˜¯å¼ºå…³è”çš„, è¿™ä¸ªå’ŒesModuleæ˜¯ä¸åŒçš„, æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»äº†è§£ä¸€ä¸‹ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«</p>
<h3 id="å¼‚æ­¥require"><a href="#å¼‚æ­¥require" class="headerlink" title="å¼‚æ­¥require"></a>å¼‚æ­¥require</h3><h4 id="å¼‚æ­¥æ¨¡å—æ•°æ®ç»“æ„"><a href="#å¼‚æ­¥æ¨¡å—æ•°æ®ç»“æ„" class="headerlink" title="å¼‚æ­¥æ¨¡å—æ•°æ®ç»“æ„"></a>å¼‚æ­¥æ¨¡å—æ•°æ®ç»“æ„</h4><p>ä¸Šé¢æ˜¯æˆ‘ä»¬æ™®é€šçš„requireæ¨¡å—çš„ç®€å•å®ç°. ä½†æ˜¯åœ¨è„±ç¦»çš„<code>node</code>ç¯å¢ƒå, å‰ç«¯èµ„æºå®é™…ä¸Šå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ä¾èµ–äºå¼‚æ­¥è·å–çš„,é‚£ä¹ˆä¸€ä¸ªéœ€è¦å¼‚æ­¥è·å–çš„æ¨¡å—åº”è¯¥è®¾è®¡æˆä»€ä¹ˆæ ·å‘¢? çœ‹çœ‹ä¸‹é¢çš„æ•°æ®ç»“æ„;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">`src/async.js`</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> asyncFn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = funA;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç»“æ„ä¿ç•™äº†æˆ‘ä»¬ä¸Šé¢<code>loadedModulesMap</code>çš„æ•°æ®ç»“æ„, æ–¹ä¾¿mergeåˆ°é‡Œé¢å», ç°åœ¨éœ€è¦è®¾è®¡ä¸€ç§åŠ è½½æœºåˆ¶, æŠŠè¿™éƒ¨åˆ†ä»£ç åŠ è½½åˆ°<code>loadedModulesMap</code>é‡Œ</p>
<h4 id="ä¸»ä»£ç å¦‚ä½•åŠ è½½å¼‚æ­¥ä»£ç "><a href="#ä¸»ä»£ç å¦‚ä½•åŠ è½½å¼‚æ­¥ä»£ç " class="headerlink" title="ä¸»ä»£ç å¦‚ä½•åŠ è½½å¼‚æ­¥ä»£ç "></a>ä¸»ä»£ç å¦‚ä½•åŠ è½½å¼‚æ­¥ä»£ç </h4><p><code>webpack</code>å®ç°äº†ä¸€ç§å¼‚æ­¥åŠ è½½çš„æ–¹æ³•<code>require.ensure</code>, æˆ‘ä»¬å°±æ²¿ç”¨æŠŠ, åªä¸è¿‡æ—¢ç„¶æ˜¯ç®€å•ç‰ˆ, å°±ä¸€ä¸ªå‚æ•°å§! æˆ‘ä»¬è®©<code>dep.js</code>å˜æˆå¼‚æ­¥åŠ è½½common.js</p>
<p><em>/dep.js</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¹‹å‰</span></span><br><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'./common.js'</span>)</span><br><span class="line"><span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = funA;</span><br><span class="line"><span class="comment">// ä¹‹å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>.ensure(<span class="string">'./common.js'</span>).then(<span class="function">(<span class="params">util</span>) =&gt;</span> &#123;</span><br><span class="line">  util.xxx();</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = funA;</span><br></pre></td></tr></table></figure></p>
<h4 id="å¼‚æ­¥æ¨¡å—è®¾è®¡"><a href="#å¼‚æ­¥æ¨¡å—è®¾è®¡" class="headerlink" title="å¼‚æ­¥æ¨¡å—è®¾è®¡"></a>å¼‚æ­¥æ¨¡å—è®¾è®¡</h4><p>æœ‰ä¸€ç‚¹å¯ä»¥è‚¯å®š, æˆ‘ä»¬è‚¯å®šä¸èƒ½ä½¿ç”¨Ajaxçš„æ–¹å¼è¿›è¡Œ, å› ä¸ºæˆ‘ä»¬éœ€è¦æ‰§è¡Œå®ƒ, æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨scriptæ ‡ç­¾, é‚£ä¹ˆåªæœ‰ä¸€æ¡è·¯äº†! JSONP!</p>
<p><em>å¼‚æ­¥æ¨¡å—</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸¤è¾¹å®šä¹‰ä¸€ä¸ªå…±æœ‰å˜é‡ JSON_LIST</span></span><br><span class="line"><span class="comment">// å¼‚æ­¥æ¨¡å—åœ¨åŠ è½½åç›´æ¥æ‰§è¡Œ, æŠŠæ¨¡å—æŒ‚è½½çš„å…¨å±€é˜Ÿåˆ—é‡Œ, ç­‰å¾…ä¸»æ¨¡å—è¯»å–</span></span><br><span class="line"><span class="built_in">window</span>.JSONP_LIST.push(</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">`src/async.js`</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> asyncFn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = funA;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><em>ä¸»æ¨¡å—</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å¼‚æ­¥åŠ è½½æ¨¡å—çš„æ–¹æ³•</span></span><br><span class="line"><span class="built_in">require</span>.ensure = <span class="function"><span class="keyword">function</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¯´æ˜å¼‚æ­¥æ¨¡å—æ²¡åŠ è½½</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦åŠ è½½è¿‡äº†</span></span><br><span class="line">    <span class="keyword">if</span> (!loadedModulesMap[path]) &#123;</span><br><span class="line">      resolve(<span class="built_in">require</span>(path));</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰scriptæ ‡ç­¾</span></span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    <span class="comment">// å…¨å±€å…¬å…±è·¯å¾„ + ç›¸å¯¹è·¯å¾„æ‹¼æ¥è¯·æ±‚, ç®€å•å¤„ç†å•¦!</span></span><br><span class="line">    <span class="keyword">var</span> url = PUBLIC_PATH + path;</span><br><span class="line">    script.url = url;</span><br><span class="line">    <span class="comment">// å®šä¹‰åŠ è½½å®Œæˆåçš„æˆåŠŸå›è°ƒ</span></span><br><span class="line">    script.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// æ¨¡å—è¯·æ±‚æˆåŠŸå, åŠ è½½é˜Ÿåˆ—é‡Œçš„æ‰€æœ‰æ¨¡å—</span></span><br><span class="line">      <span class="built_in">window</span>.JSONP_LIST.forEach(<span class="function">(<span class="params">moduleObj</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">Object</span>.keys(moduleObj).forEach(<span class="function">(<span class="params">_path</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (!loadedModulesMap[_path]) &#123;</span><br><span class="line">            loadedModulesMap[_path] = moduleObj[_path];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;) </span><br><span class="line">      <span class="comment">// å¤„ç†äº†JSON_LISTé‡Œé¢å·²ç»åŠ è½½éƒ­çš„æ¨¡å—å°±è¦æ¸…ç©º</span></span><br><span class="line">      <span class="built_in">window</span>.JSON_LIST = [];</span><br><span class="line">      <span class="comment">// è¿™æ—¶ å·²ç»æˆåŠŸåŠ è½½äº†å¼‚æ­¥æ¨¡å—, è¿™æ—¶å€™è¿”å›æ¨¡å—å€¼</span></span><br><span class="line">      <span class="keyword">if</span> (!loadedModulesMap[path]) &#123;</span><br><span class="line">        resolve(<span class="built_in">require</span>(path));</span><br><span class="line">      &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="ä¸€äº›å…¶ä»–ç»†èŠ‚"><a href="#ä¸€äº›å…¶ä»–ç»†èŠ‚" class="headerlink" title="ä¸€äº›å…¶ä»–ç»†èŠ‚"></a>ä¸€äº›å…¶ä»–ç»†èŠ‚</h4><p>åœ¨å¢åŠ äº†<code>require.ensure</code>ä¹‹å, ä½ éœ€è¦åœ¨è§£ææ–‡ä»¶çš„æ—¶å€™è€ƒè™‘å¼‚æ­¥åŠ è½½çš„æƒ…å†µ:</p>
<ul>
<li>è§£æ<code>require.ensure</code>çš„è°ƒç”¨</li>
<li>å¼‚æ­¥åº”ä¾èµ–çš„å­æ ‘å•ç‹¬ç”Ÿæˆå¼‚æ­¥æ¨¡å—æ–‡ä»¶</li>
</ul>
<p>æœ€åç”Ÿæˆçš„ä»£ç åº”è¯¥æ˜¯:</p>
<p>ä¸»æ–‡ä»¶<em>main.js</em>:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loadedModulesMap = &#123;</span><br><span class="line">  <span class="string">'src/dep.js'</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> moduleA = <span class="built_in">require</span>.ensure(<span class="string">'src/common.js'</span>)</span><br><span class="line">    <span class="keyword">var</span> funA = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = funA;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cacheModulesMap = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(path) &#123;</span><br><span class="line">  <span class="keyword">if</span> (cacheModulesMap[path]) &#123;</span><br><span class="line">    <span class="keyword">return</span> cacheModulesMap[path].exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">module</span> = cacheModulesMap[path] = &#123; <span class="attr">exports</span>: &#123;&#125; &#125;;</span><br><span class="line">  <span class="keyword">const</span> modulesFn = loadedModulesMap.path;</span><br><span class="line">  modulesFn(<span class="built_in">require</span>, <span class="built_in">module</span>, <span class="built_in">module</span>.exports );</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">module</span>.export;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>.ensure = <span class="function"><span class="keyword">function</span>(<span class="params">path</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!loadedModulesMap[path]) &#123;</span><br><span class="line">      resolve(<span class="built_in">require</span>(path));</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    <span class="keyword">var</span> url = PUBLIC_PATH + path;</span><br><span class="line">    script.url = url;</span><br><span class="line">    script.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">window</span>.JSONP_LIST.forEach(<span class="function">(<span class="params">moduleObj</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">Object</span>.keys(moduleObj).forEach(<span class="function">(<span class="params">_path</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (!loadedModulesMap[_path]) &#123;</span><br><span class="line">            loadedModulesMap[_path] = moduleObj[_path];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;) </span><br><span class="line">      <span class="built_in">window</span>.JSON_LIST = [];</span><br><span class="line">      <span class="keyword">if</span> (!loadedModulesMap[path]) &#123;</span><br><span class="line">        resolve(<span class="built_in">require</span>(path));</span><br><span class="line">      &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moduleA = <span class="built_in">require</span>(<span class="string">'src/dep.js'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello world'</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¼‚æ­¥æ–‡ä»¶<em>src/common.js</em>;<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.JSONP_LIST.push(</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">`src/common.js`</span>: <span class="function"><span class="keyword">function</span>(<span class="params">require, module, exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> util = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    <span class="built_in">module</span>.exports = util;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h3><p>ä»¥ä¸Šåªæ˜¯ä¸€ä¸ªéå¸¸éå¸¸ç®€å•çš„æ¨¡å—åŠ è½½ç³»ç»Ÿ, ç©å…·ä¸­çš„ç©å…·, ä½†æ˜¯è¿™ä¸å¦¨ç¢æˆ‘ä»¬ç†è§£<code>js</code>æ¨¡å—åŒ–çš„æœ¬è´¨, åªè¦çœ‹æ˜ç™½æœ¬è´¨, å®é™…ä¸Š<code>webpack</code>é‚£äº›<br>çœ¼èŠ±ç¼­ä¹±çš„æ“ä½œä¹Ÿå°±ä¸å†é‚£ä¹ˆç¥å¥‡äº†</p>
<p>å¦‚æœä¹‹åæœ‰æœºä¼š, æˆ‘ä¹Ÿè®¸ä¼šåœ¨è¿™ä¸ªç¯‡æ–‡ç« é‡Œè¡¥å…¨ç®€æ˜“ç‰ˆçš„webpack module federation, æ•¬è¯·æœŸå¾…â€¦â€¦</p>
<p>ä¹Ÿè®¸æ˜¯åä¼šæ— æœŸ?(å¤§ç¬‘ğŸ˜„,é€ƒâ€¦â€¦)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/04/27/å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ/" data-id="ck9ik1ty2000bwhroxhlsr1d2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/03/29/å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿ/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿ</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/webpack/" style="font-size: 10px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/27/å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ/">å¦‚ä½•è®¾è®¡ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿ</a>
          </li>
        
          <li>
            <a href="/2020/03/29/å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿ/">å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿ</a>
          </li>
        
          <li>
            <a href="/2020/01/31/æ·±å…¥webpack-æ’ä»¶/">æ·±å…¥webpack-æ’ä»¶</a>
          </li>
        
          <li>
            <a href="/2019/12/20/æ·±å…¥webpack-tapableç¯‡/">æ·±å…¥webpack-tapableç¯‡</a>
          </li>
        
          <li>
            <a href="/2019/11/22/å‰ç«¯Né¢-elm-lang/">å‰ç«¯Né¢-elm-lang</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>